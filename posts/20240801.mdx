---
title: AzureでIPを固定したい時
description: Azure上で静的IPを設定し、VNETなどを構築する方法をご紹介します。
date: 2024-08-01
tags:
    - 静的IP
    - NATゲートウェイ
    - VNET
---

## はじめに
こんにちは、ITコンサルをやっているまるやきです。<br />
API制限で固定IPでの通信のみ許可されているときありますよね〜
煩わしいですが、セキュアなAPI通信を実現するためには仕方ないことです。<br />
今回はAzure上で固定IPを設定する方法を解説していきます。

## 使用するAzureサービス
以下の3つを使用します。
- パブリックIPアドレス
- NATゲートウェイ
- 仮想ネットワーク

順番にそれぞれどのような設定で作成していくのか解説していきます。

## パブリックIPアドレスの作成
まずは固定するIPを作成していきます。
パブリックIPアドレス作成ページから作成ボタンをクリックしましょう。<br />
設定は主に以下画像のIPアドレスの割り当てに気をつけましょう。
SKUをBasicに下げると動的も選べてしまいますが、この部分が静的になっていないと固定IPでなくなってしまいます。

**2025 年 9 月 30 日に、Azure Basic パブリック IP は廃止されるので、どちらにせよ選択するのはおすすめしません。**

![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3568119/b1f180ee-67a3-7aa7-ca92-080350904d78.png)
特段気にすること（可用性ゾーンやタイムアウト設定など）がなければ、必須事項を入力して、そのまま作成してしまって問題ありません。

作成したパブリックIPアドレスのページ（以下画像）に行き、「IPアドレス」が設定されていれば問題ありません。<br />
「関連付け先」は私の画面だと表示されていますが、ご一緒に設定されている方は、表示されていません。
後からNATゲートウェイと連携するので、その際に「関連付け先」へNATゲートウェイのリソース名が表示されます。
![863F8C43-F3B2-433B-A228-CFCE5ADDF128_1_201_a.jpeg](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3568119/cd106a62-6740-aec9-88b3-31ddcb1e6d40.jpeg)

## NATゲートウェイの作成
次はNATゲートウェイを作成していきます。
NATゲートウェイ作成ページに行き、作成ボタンをクリックしましょう。<br />
NATゲートウェイの作成は、以下のパブリックIPアドレスを選択する項目だけ気をつけましょう。
プルダウンをクリックすると、先ほど作成した静的IPアドレスが出てくるので、それを選択してください。<br />
サブネットはこの後仮想ネットワークを作成した後に設定するので、一旦無視で作成しましょう。
![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3568119/f1bd57d6-3e78-48e1-729a-ee250ed2ae09.png)

作成が終わったらパブリックIPの画面に行って、パブリックIPの最後で話題に出した「関連付け先」にNATゲートウェイのリソース名が表示されていれば問題ありません。

## 仮想ネットワークの作成
最後に仮想ネットワークを作成していきます。
今まで同様、仮想ネットワーク作成ページから作成ボタンをクリックします。<br />
今回は少しややこしい画面が出ますが、基本いじらないので大丈夫です。
基本・セキュリティタブで必要事項を入力できたらIPアドレスタブに移動してください。<br />
defaultサブネットを鉛筆マークをクリックして編集していきます。
![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3568119/39c92c1f-aa0c-5737-cd2e-c1950535600e.png)

鉛筆マークをクリックすると、メニューが出現するので、NATゲートウェイの項目のプルダウンをクリックし、先ほど作成したNATゲートウェイを選択して保存します。
![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3568119/565fbcdf-dae8-e99d-900b-ea4ca6dbf12f.png)

こちらで設定は以上なので、タブを先に進めて作成しましょう。
固定IPを使用するための設定も以上になります！

## さいごに
今回はAzure上で固定IPを使うために実施することを紹介させていただきました。<br />
例えばApp Serviceで固定IPを設定したい場合は、App Serviceのネットワークメニューから仮想ネットワーク統合を設定すれば、送信トラフィックのIPを固定化できます。<br />
やりたいことに対して、使うサービスは多いもののやることは単純ですね。<br />
これからVMやApp Serviceなどで固定IPを設定しないといけなくなった際の参考になれば幸いです。


